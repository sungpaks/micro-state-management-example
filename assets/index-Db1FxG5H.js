import{c as p,j as t,r as c}from"./index-Cnn1VRaE.js";import{B as a,R as S,E as x}from"./RenderCount-aNSM8aoX.js";import{s as u}from"./store-Bdmtnt4j.js";import{E as l}from"./ExampleLink-DD7GIU0V.js";/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var g=p("outline","chevrons-down","IconChevronsDown",[["path",{d:"M7 7l5 5l5 -5",key:"svg-0"}],["path",{d:"M7 13l5 5l5 -5",key:"svg-1"}]]);let m=10;const h=()=>{const[e,s]=c.useState(m),n=()=>s(e+1);return t.jsxs("div",{children:[e," ",t.jsx(a,{onClick:n,children:"+1"})]})},b=()=>{const[e,s]=c.useState(m),n=()=>s(e+2);return t.jsxs("div",{children:[e," ",t.jsx(a,{onClick:n,children:"+2"})]})};function C(){return t.jsxs(t.Fragment,{children:[t.jsx(h,{}),t.jsx(h,{}),t.jsx(b,{}),t.jsx("img",{src:"https://i.imgur.com/Sc1kqwl.png",alt:"Module State 예제: 구독 없는 경우"}),t.jsxs("p",{children:["위와 같이 각 컴포넌트들이 ",t.jsx("code",{children:"count"}),"라는 Module State로 상태를 만들지만, ",t.jsx("br",{}),"각 상태들은 서로 독립적이므로 서로의 상태 변화가 공유되지 않습니다."]}),t.jsx("p",{children:"상태를 공유하기 위한 (아주 단순한) 접근 방법은 setState함수들을 한번에 트리거하는 것입니다."})]})}let r=10;const i=new Set,j=()=>{const[e,s]=c.useState(r);c.useEffect(()=>(i.add(s),()=>{i.delete(s)}),[]);const n=()=>{r+=1,i.forEach(o=>o(r))};return t.jsxs("div",{children:[e," ",t.jsx(a,{onClick:n,children:"+1"})]})},w=()=>{const[e,s]=c.useState(r);c.useEffect(()=>(i.add(s),()=>{i.delete(s)}),[]);const n=()=>{r+=2,i.forEach(o=>o(r))};return t.jsxs("div",{children:[e," ",t.jsx(a,{onClick:n,children:"+2"})]})};function f(){return t.jsxs(t.Fragment,{children:[t.jsx(j,{}),t.jsx(j,{}),t.jsx(w,{}),t.jsx("img",{src:"https://i.imgur.com/rVipLIl.png",alt:"Module State 예제: 아주 naive한 구독 예시"}),t.jsxs("p",{children:["예컨대 위와 같이 ",t.jsx("code",{children:"setState"})," 함수들을 모아두고,",t.jsx("br",{})," 상태 업데이트 시 이를 모두 트리거합니다."]}),t.jsx("p",{children:"그러나 이 방법은 그다지 현실적이진 않습니다. 반복적인 코드가 너무 많네요."})]})}function d(e){const[s,n]=c.useState(e.getState());return c.useEffect(()=>{const o=e.subscribe(()=>{n(e.getState())});return n(e.getState()),o},[e]),[s,e.setState]}const E=()=>{const[e,s]=d(u),n=()=>s(o=>({...o,count:o.count+1}));return t.jsxs("div",{children:[e.count," ",t.jsx(a,{onClick:n,children:"+1"})]})},k=()=>{const[e,s]=d(u),n=()=>s(o=>({...o,count:o.count+2}));return t.jsxs("div",{children:[e.count," ",t.jsx(a,{onClick:n,children:"+2"})]})},v=()=>{const[e]=d(u);return t.jsxs("div",{children:["STORE NAME: ",t.jsx("code",{className:"bg-amber-100",children:e.name})," ",t.jsx(S,{})]})};function M(){return t.jsxs(t.Fragment,{children:[t.jsx(E,{}),t.jsx(k,{}),t.jsx(v,{}),t.jsx("img",{src:"https://i.imgur.com/Odz3mOh.png",alt:"createStore 예제 코드"}),t.jsxs("p",{children:["Module State + Subscription을 좀 더 현실적으로 구현하고자 ",t.jsx("code",{children:"createStore"}),"함수를 만들었습니다."]}),t.jsxs("p",{children:[t.jsx("code",{children:"store"}),"는 내부에 상태값을 유지하고, ",t.jsx("code",{children:"getState, setState, subscribe"}),"를 메서드로 가지는 하나의 module state입니다."]}),t.jsx("img",{src:"https://i.imgur.com/BMlKRnZ.png",alt:"useStore 커스텀훅 예제 코드"}),t.jsx("img",{src:"https://i.imgur.com/pZ0gFiu.png",alt:"useStore 커스텀훅 사용 예제"}),t.jsxs("p",{children:["이제 ",t.jsx("code",{children:"useStore"})," 커스텀훅을 사용하여 store 상태값을 구독하여 조회하거나 변경합니다."]}),t.jsxs("p",{children:["그러나 ",t.jsx("code",{children:"useStore"}),"는 상태값 객체 전체를 반환하므로,",t.jsx("br",{}),"객체의 일부만 변한 경우에도 ",t.jsx("code",{children:"useStore"}),"를 사용하는 모든 컴포넌트가 불필요하게 리렌더링됩니다."]})]})}const y=function(){return t.jsxs(t.Fragment,{children:[t.jsx("h1",{className:"text-xl mt-8",children:"Sharing Module State with Subscription"}),t.jsx("h2",{children:"Module State와 Subscription 기법으로 상태를 전역적으로 공유하는 방법을 알아봅니다."}),t.jsxs(x,{title:"Using a module state as a global state in React",children:[t.jsx(C,{}),t.jsx(g,{className:"text-amber-700 w-10 h-5 scale-x-150"}),t.jsx(f,{})]}),t.jsxs(x,{title:"Adding a basic Subscription",children:[t.jsx(M,{}),t.jsx(l,{to:"/sharing-module-state-with-subscription/working-with-a-selector",children:"Solution1: Working with a selector"}),t.jsx(l,{to:"/sharing-module-state-with-subscription/working-with-use-subscription",children:"Solution2: Working with useSubscription"}),t.jsxs(l,{to:"/sharing-module-state-with-subscription/working-with-use-sync-external-store",children:["Solution3: Working with useSyncExternalStore ",t.jsx("i",{children:"(React 18+)"})]})]})]})};export{y as component};
